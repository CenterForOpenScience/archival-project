if(typeof PFGlobal=="undefined")var PFGlobal={SourceLoad:{ControlBase:false}};else if(typeof PFGlobal.SourceLoad=="undefined")PFGlobal.SourceLoad={ControlBase:false};else if(typeof PFGlobal.SourceLoad.ControlBase=="undefined")PFGlobal.SourceLoad.ControlBase=false;var flagcallback=false,AuthTokeFromPF="";function ControlBase(){this.SupportedSnapouts={};this.AssignedSnapouts={};this.PreserveCommonSnapouts=false;this.Container=null;this.Brand=null;this.ResponseContainer="body";this.JSLoadCtr=0;this.OnNavigationStart=[];this.OnNavigationComplete=[];this.OnRenderComplete=[];this.login=null;this.AuthToken=""}ControlBase.prototype.PostLoginEvents=[];ControlBase.prototype.SSOComplete=false;ControlBase.prototype.SSOStarted=false;ControlBase.prototype.AddPostLoginEvent=function(a){if(!ControlBase.prototype.SSOComplete)ControlBase.prototype.PostLoginEvents[ControlBase.prototype.PostLoginEvents.length]=a;else a()};ControlBase.prototype.LoginComplete=function(a,c){if(ControlBase.prototype.SSOStarted)return;ControlBase.prototype.SSOStarted=true;var b;if(a==""||a==null)b=null;else b=a;var d='<iframe title="PROVIDERFINDER RESULTS" id="PF_results" name="PF_results" style="display: none" onload="CallBackAfterLocation('+b+');">PROVIDERFINDER RESULTS</iframe>';$("body").append(d);window.frames.PF_results.location.href=c};function CallBackAfterLocation(b){var e="",a,c,f;if($.browser.msie&&$.browser.version=="6.0"){if(flagcallback){try{e=window.frames.PF_results.location.href;c=getUrlVarsWidget(e);a=c.authtoken;f=c.status;AuthTokeFromPF={token:a}}catch(g){}if((typeof a=="undefined"||a==null||a=="")&&f!="failure")return;(typeof b==="function"||typeof b==="object")&&b!=null&&b();flagcallback=false;for(var d=0;d<ControlBase.prototype.PostLoginEvents.length;d++)ControlBase.prototype.PostLoginEvents[d]();ControlBase.prototype.SSOComplete=true}flagcallback=true}else{try{e=window.frames.PF_results.location.href;c=getUrlVarsWidget(e);a=c.authtoken;f=c.status;AuthTokeFromPF={token:a}}catch(g){}if((typeof a=="undefined"||a==null||a=="")&&f!="failure")return;(typeof b==="function"||typeof b==="object")&&b!=null&&b();for(var d=0;d<ControlBase.prototype.PostLoginEvents.length;d++)ControlBase.prototype.PostLoginEvents[d]();ControlBase.prototype.SSOComplete=true}}ControlBase.prototype.JSLoadCallback=function(a,d){a.JSLoadCtr[d]=true;if(a.readyeventfired)return;var c=true;for(var e in a.JSLoadCtr)c&=a.JSLoadCtr[e];if(c&&typeof a.Ready!="undefined"){a.Ready();for(var b=0;b<a.OnRenderComplete.length;b++)a.OnRenderComplete[b]();a.readyeventfired=true}};ControlBase.prototype.RegisterNavigationStartEvent=function(a){this.OnNavigationStart[this.OnNavigationStart.length]=a};ControlBase.prototype.RegisterNavigationCompleteEvent=function(a){this.OnNavigationComplete[this.OnNavigationComplete.length]=a};ControlBase.prototype.RegisterRenderCompleteEvent=function(a){this.OnRenderComplete[this.OnRenderComplete.length]=a};ControlBase.prototype.NavParams=null;ControlBase.prototype.Navigate=function(f,c,a){for(var b in a)if(typeof a[b]=="object")if(a[b].hasOwnProperty("selector"))a[b]=a[b].selector;else if(a[b].hasOwnProperty("id"))a[b]="#"+a[b].id;else if(a[b].hasOwnProperty("name"))a[b]="#"+a[b].name;this.NavParams={};this.NavParams[f]=a;this.NavControlType=f;for(var e=true,d=0;d<this.OnNavigationStart.length;d++)e=e&this.OnNavigationStart[d](this,c,a);if(!e)return;if(typeof this.PreserveCommonSnapouts=="boolean"&&this.PreserveCommonSnapouts)for(var b in c.SupportedSnapouts)if(typeof this.AssignedSnapouts[b]!="undefined")c.AssignedSnapouts[b]=this.AssignedSnapouts[b];c.Init(a);c.Load();for(var d=0;d<this.OnNavigationComplete.length;d++)e=e&this.OnNavigationComplete[d](this,c,a)};ControlBase.prototype.LoadWithParams=function(f,b,c){if(typeof this.loaded!="undefined"&&this.loaded)return;this.loaded=true;var a=this,d=f+b;if(this.Brand!=null)if(c==null)c={brand:this.Brand};else c.brand=this.Brand;if(this.AuthToken!="")if(c==null)c={authToken:this.AuthToken};else c.authToken=this.AuthToken;function e(b){return function(){ControlBase.prototype.JSLoadCallback(a,b)}}a.JSLoadCtr={dom:false};a.readyeventfired=false;$.ajax({url:d.indexOf("?")==-1?d+"?callback=?":d+"&callback=?",dataType:"json",data:c,success:function(i){for(var g=0;g<i.length;g++){var c=i[g];if(c.label=="script"){for(var d=0;d<c.scripts.length;d++)if(c.scripts[d].type=="External")a.JSLoadCtr[d]=false;for(var d=0;d<c.scripts.length;d++){var f=document.createElement("script");f.setAttribute("type","text/javascript");if(c.scripts[d].type=="External"){f.setAttribute("src",c.scripts[d].content);f.onload=e(d);f.onreadystatechange=e(d)}else f.text=c.scripts[d].content;document.getElementsByTagName("head")[0].appendChild(f)}continue}if(c.label=="main"){$(a.Container).hide();$(a.Container)[0].innerHTML=c.content}else $(a.Container+" div#"+c.label).before(c.content).remove();if(c.last){for(var h in a.AssignedSnapouts){var j=$(a.Container+' div[id$="Snapout_'+a.SupportedSnapouts[h]+'"]').clone();$(a.Container+' div[id$="Snapout_'+a.SupportedSnapouts[h]+'"]').remove();$(a.AssignedSnapouts[h]).append(j)}$(a.Container).show();a.readyeventfired=false;ControlBase.prototype.JSLoadCallback(a,"dom")}}if(b.indexOf("page=finda-doctor")<0&&b.indexOf("page=search-results")<0&&b.indexOf("page=searchresults")<0&&b.indexOf("page=findadoctor")<0&&b.indexOf("page=estimatecost")<0)ResponseTimeMonitor&&ResponseTimeMonitor.SendWebTrendData(b);if(b.indexOf("page=search-results")>=0||b.indexOf("page=searchresults")>=0){foresee_pf="true";typeof FSR!="undefined"&&FSR.run()}},error:function(){}})};ControlBase.prototype.Init=function(a){if(a.hasOwnProperty("Snapouts"))for(var b in this.SupportedSnapouts)if(a.Snapouts.hasOwnProperty(this.SupportedSnapouts[b]))this.AssignedSnapouts[this.SupportedSnapouts[b]]=a.Snapouts[this.SupportedSnapouts[b]];if(a.hasOwnProperty("brand"))this.Brand=a.brand;if(a.hasOwnProperty("PreserveCommonSnapouts"))this.PreserveCommonSnapouts=a.PreserveCommonSnapouts;this.Container="#"+a.Container;this.SourceUrl=a.SourceUrl;if(a.AuthToken==null||a.AuthToken==""||typeof a.AuthToken=="undefined"||AuthTokeFromPF.token!=null&&AuthTokeFromPF.token!=""&&typeof AuthTokeFromPF.token!="undefined"&&a.AuthToken!=AuthTokeFromPF.token)this.AuthToken=AuthTokeFromPF.token;else this.AuthToken=a.AuthToken};function getUrlVarsWidget(e){for(var b=[],a,d=e.slice(e.indexOf("?")+1).split("&"),c=0;c<d.length;c++){a=d[c].split("=");b.push(a[0]);b[a[0]]=a[1]}return b}function removeURLParam(d,f){var b=d.split("?");if(b.length>=2){for(var e=encodeURIComponent(f)+"=",a=b[1].split(/[&;]/g),c=a.length;c-->0;)a[c].indexOf(e,0)==0&&a.splice(c,1);return a.length>0?b[0]+"?"+a.join("&"):b[0]}else return d}function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+a+"=([^&#]*)",d=new RegExp(c),b=d.exec(window.location.search);return b==null?"":decodeURIComponent(b[1].replace(/\+/g," "))}PFGlobal.SourceLoad.ControlBase=true